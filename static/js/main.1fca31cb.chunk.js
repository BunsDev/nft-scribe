(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{130:function(e,t,n){e.exports=n(353)},136:function(e,t){},138:function(e,t){},160:function(e,t,n){},166:function(e,t){},168:function(e,t){},353:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n.n(a),l=n(56),c=n(32),i=n(2),o=n(119),s=n(43),u=n(129),d=(n(160),n(125)),m=n(126),p="https://mainnet.infura.io/v3/84842078b09946638c03157f83405213",f="https://rinkeby.infura.io/v3/84842078b09946638c03157f83405213",b=new d.a({supportedChainIds:[1,3,4,5,42]});new m.a({urls:{1:p,4:f},defaultChainId:1,pollingInterval:8e3});var h=n(68),E=[{inputs:[{internalType:"address",name:"dictator",type:"address",indexed:!1},{internalType:"address",name:"tokenAddress",type:"address",indexed:!1},{indexed:!1,internalType:"uint256",name:"tokenId",type:"uint256"},{indexed:!1,internalType:"string",name:"text",type:"string"}],type:"event",anonymous:!1,name:"Record"},{inputs:[{internalType:"address",name:"_tokenAddress",type:"address"},{internalType:"uint256",name:"_tokenId",type:"uint256"},{internalType:"string",name:"_text",type:"string"}],name:"dictate",type:"function",constant:!1,outputs:[],payable:!1,stateMutability:"nonpayable"},{inputs:[{internalType:"bytes",name:"",type:"bytes"},{internalType:"uint256",name:"",type:"uint256"}],name:"documents",type:"function",constant:!0,outputs:[{internalType:"address",name:"dictator",type:"address"},{internalType:"string",name:"text",type:"string"},{internalType:"uint256",name:"creationTime",type:"uint256"}],payable:!1,stateMutability:"view"},{inputs:[{internalType:"bytes",name:"",type:"bytes"}],name:"documentsCount",type:"function",constant:!0,outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view"},{constant:!0,inputs:[{internalType:"address",name:"_tokenAddress",type:"address"},{internalType:"uint256",name:"_tokenId",type:"uint256"}],name:"getDocumentKey",outputs:[{internalType:"bytes",name:"",type:"bytes"}],payable:!1,stateMutability:"pure",type:"function"}],y=[{constant:!0,inputs:[{name:"_tokenId",type:"uint256"}],name:"ownerOf",outputs:[{name:"_owner",type:"address"}],payable:!1,stateMutability:"view",type:"function"}],g="0x9831151655180132E6131AB35A82a5e32C149116",v="0x284Dc68Afe4b30793acb7507a0Ae029d91bf698e",T="0xC207efACb12a126D382fA28460BB815F336D845f",N="",I=0,D={UNLOADED:0,LOADING_RECORDS:1,LOADED:2,SUBMITTING_DICTATION:3};function k(e){var t=new u.a(e);return t.pollingInterval=8e3,t}function O(){var e=Object(s.b)(),t=e.connector,n=e.library,a=e.chainId,o=e.account,u=e.activate,d=i.useState([]),m=Object(c.a)(d,2),p=m[0],f=m[1],k=i.useState(D.UNLOADED),O=Object(c.a)(k,2),w=O[0],C=O[1];function A(){var e=document.getElementById("dictation").value.trim();return 0===e.length?null:e}function _(e){return 1===e?T:3===e?g:5===e?v:""}function x(e){return 1===e?"Mainnet":5===e?"Goerli":"..."}function S(){var e=document.getElementById("tokenId").value.trim();return e=parseInt(e),isNaN(e)||e<0?null:e}function j(){var e=document.getElementById("tokenAddress").value;try{return h.utils.getAddress(e)}catch(t){return null}}function L(e){return M.apply(this,arguments)}function M(){return(M=Object(l.a)(r.a.mark((function e(t){var l,c,i,s,u;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(l=A())){e.next=4;break}return window.alert("Please provide a dictation."),e.abrupt("return");case 4:return console.log("Submitting dictation..."),c=new h.utils.Interface(E),i=c.functions.dictate.encode([N,I,l]),s={to:_(a),data:i,gasPrice:h.utils.bigNumberify(1e9*t)},u=n.getSigner(o),e.prev=9,e.next=12,u.sendTransaction(s).then((function(e){R(e)}));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),C(D.LOADED);case 17:case"end":return e.stop()}}),e,null,[[9,14]])})))).apply(this,arguments)}function R(e){return B.apply(this,arguments)}function B(){return(B=Object(l.a)(r.a.mark((function e(t){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=h.getDefaultProvider(a),e.next=3,n.waitForTransaction(t.hash);case 3:C(D.LOADING_RECORDS),P();case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(){H(""),Z(""),C(D.UNLOADED)}function P(){return U.apply(this,arguments)}function U(){return(U=Object(l.a)(r.a.mark((function e(){var t,n,l,c,i,s,u,d,m,p,b,g;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j(),n=S(),l=h.getDefaultProvider(a),c=new h.Contract(_(a),E,l),e.next=6,c.getDocumentKey(t,n);case 6:return i=e.sent,e.next=9,c.documentsCount(i);case 9:s=e.sent.toString(),u=[],d=0;case 12:if(!(d<s)){e.next=24;break}return e.next=15,c.documents(i,d);case 15:return m=e.sent,p=h.utils.getAddress(m.dictator),e.next=19,l.lookupAddress(p);case 19:m.ensName=e.sent,u.splice(0,0,m);case 21:d++,e.next=12;break;case 24:return N=t,I=n,f(u),b=new h.Contract(N,y,l),e.next=30,b.ownerOf(I);case 30:g=e.sent,V(o===g),C(D.LOADED);case 33:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F=i.useState(!1),J=Object(c.a)(F,2),K=J[0],V=J[1],z=i.useState(""),W=Object(c.a)(z,2),q=W[0],H=W[1],Q=i.useState(""),X=Object(c.a)(Q,2),Y=X[0],Z=X[1],$=i.useState(),ee=Object(c.a)($,2),te=ee[0],ne=ee[1];return i.useEffect((function(){te&&te===t&&ne(void 0)}),[te,t]),function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(s.b)(),n=t.active,a=t.error,r=t.activate;Object(i.useEffect)((function(){var t=window.ethereum;if(t&&!n&&!a&&!e){var l=function(e){console.log("networkChanged",e),r(b)},c=function(e){console.log("accountsChanged",e),e.length>0&&r(b)};return t.on("networkChanged",l),t.on("accountsChanged",c),function(){t.removeListener("networkChanged",l),t.removeListener("accountsChanged",c)}}return function(){}}),[n,a,e,r])}(!function(){var e=Object(s.b)(),t=e.activate,n=e.active,a=Object(i.useState)(!1),r=Object(c.a)(a,2),l=r[0],o=r[1];return Object(i.useEffect)((function(){b.isAuthorized().then((function(e){e?t(b,void 0,!0).catch((function(){o(!0)})):o(!0)}))}),[t]),Object(i.useEffect)((function(){!l&&n&&o(!0)}),[l,n]),l}()||!!te),i.createElement("div",null,i.createElement("div",{className:"padded-div"},i.createElement("label",null,i.createElement("i",null,"NFT Scribe")," is a smart contract that allows ERC721 owners to append onchain messages and annotations to their tokens.")),i.createElement("hr",null),i.createElement("div",{className:"center-header-images-container"},i.createElement("div",{className:"inner-header-images"},i.createElement("img",{className:"hero-image",src:"scribe.gif",alt:"Scribe"}),0===q.length&&i.createElement("img",{className:"nft-outline",alt:"Outline",src:"nft_outline.png"}),0!==q.length&&i.createElement("img",{alt:"Token",className:"nft-overlay",src:q}),0!==Y.length&&i.createElement("label",{className:"nft-overlay"},Y),(w===D.LOADING_RECORDS||w===D.SUBMITTING_DICTATION)&&i.createElement("img",{alt:"Spinner",className:"loading-spinner",src:"loading.gif"}))),i.createElement("br",null),i.createElement("div",null,i.createElement("div",{className:"main-section"},i.createElement("label",null,i.createElement("b",null,"Token Address")),i.createElement("input",{id:"tokenAddress",placeholder:"0x..."}),i.createElement("label",null,i.createElement("b",null,"Token ID")),i.createElement("input",{id:"tokenId",type:"number",placeholder:"0, 1, 2, 3...",min:"0",defaultValue:"0"}),i.createElement("div",{className:"button-container"},!(!n||!o)&&i.createElement("button",{disabled:w===D.LOADING_RECORDS,className:"load-erc",onClick:function(){(null==j()?(window.alert("Please provide a valid ERC721 contract address."),0):null!=S()||(window.alert("Please provide a valid ERC721 token ID."),0))&&(C(D.LOADING_RECORDS),function(e){H(""),Z("");var t=S(),n="https://api.opensea.io/api/v1/assets?token_ids="+t+"&asset_contract_address="+j();console.log(n),fetch(n,{crossDomain:!0,method:"POST",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(n){var a;console.log(n),n.assets.length>0?(H(null===(a=n.assets[0]).image_url?"":a.image_url),Z(function(e,t){return null!==e.name?e.name:null!==e.asset_contract&&null!==e.asset_contract.name?e.asset_contract.name+" #"+t:void 0}(n.assets[0],t))):(H("image-not-found.png"),Z("n/a")),e().catch((function(e){window.alert(e),G()}))})).catch((function(e){window.alert(e),G()}))}(P))}},i.createElement("b",null,"Load ERC721")),!1===!!n&&i.createElement("button",{className:"connect-web3",onClick:function(){ne(b),u(b)}},"Connect to Web3")),w!==D.UNLOADED&&w!==D.LOADING_RECORDS&&K&&i.createElement("div",null,i.createElement("label",null,i.createElement("b",null,"Dictation")),i.createElement("input",{disabled:w===D.SUBMITTING_DICTATION,id:"dictation",placeholder:"Let it be known..."}),i.createElement("div",{className:"button-container"},i.createElement("button",{disabled:w===D.SUBMITTING_DICTATION,className:"submit-dictation",onClick:function(){var e;(null!==A()||(window.alert("Please provide a dictation."),0))&&(C(D.SUBMITTING_DICTATION),e=L,fetch("https://ethgasstation.info/json/ethgasAPI.json").then((function(e){return e.json()})).then((function(t){var n=t.fast;void 0===n?n=10:n/=10,e(n)})))}},i.createElement("b",null,"Submit Dictation")))),(w===D.LOADED||w===D.SUBMITTING_DICTATION)&&function(){var e=[];return p.forEach((function(t){var n=function(e){var t=(new Date).getTime()/1e3,n=Math.floor(t-e),a=Math.floor(n/60),r=Math.floor(a/60),l=Math.floor(r/24);return l>0?1===l?l+" day ago":l+" days ago":r>0?1===r?r+" hour ago":r+" hours ago":a>0?a+" min ago":n>0?1===n?n+" second ago":n+" seconds ago":"just recently"}(t.creationTime),r=t.text,l=x(a),c=null;if(c="Mainnet"===l?"https://etherscan.io/address/"+t.dictator:"https://"+l+".etherscan.io/address/"+t.dictator,null===t.ensName){var o=(t.dictator,"0x33b93...3243");e.push(i.createElement("div",{className:"record-line",key:r+t.creationTime.toString()},i.createElement("label",{className:"record-line"},i.createElement("b",null,i.createElement("a",{href:c,rel:"noopener noreferrer",target:"_blank"},o)),i.createElement("span",{className:"timestamp"}," \u2022 (",n,")"),i.createElement("br",null),i.createElement("br",null),r)))}else e.push(i.createElement("div",{className:"record-line",key:t.creationTime.toString()},i.createElement("label",{className:"record-line"},i.createElement("b",null,i.createElement("a",{href:c,rel:"noopener noreferrer",target:"_blank"},t.ensName)),i.createElement("span",{className:"timestamp"}," \u2022 (",n,")"),i.createElement("br",null),i.createElement("br",null),r)))})),0===e.length&&e.push(i.createElement("label",{key:"0"},"No records found for this token.")),e}())),i.createElement("hr",null),i.createElement("div",{className:"padded-div"},i.createElement("label",null,"Version 1.0 | ",i.createElement("b",null,i.createElement("a",{href:"https://github.com/conlan/nft-scribe",target:"_blank",rel:"noopener noreferrer"},"Github"))," | ",i.createElement("b",null,i.createElement("a",{href:"https://etherscan.io/address/0xC207efACb12a126D382fA28460BB815F336D845f",target:"_blank",rel:"noopener noreferrer"},"Contract"))," | ",i.createElement("b",null,i.createElement("a",{href:"https://twitter.com/conlan",target:"_blank",rel:"noopener noreferrer"},"@Conlan"))," | "),i.createElement("label",null,"\u26d3",x(a)),i.createElement("br",null),i.createElement("label",null,"Please use at your own risk and double check ",i.createElement("a",{href:"https://ethgasstation.info/",target:"_blank",rel:"noopener noreferrer"},"gas price")," before submitting transaction \u26fd")))}o.render(i.createElement((function(){return i.createElement(s.a,{getLibrary:k},i.createElement(O,null))}),null),document.getElementById("root"))}},[[130,1,2]]]);
//# sourceMappingURL=main.1fca31cb.chunk.js.map